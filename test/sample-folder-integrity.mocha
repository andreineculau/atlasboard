var assert = require ('assert'),
    path = require ('path'),
    fs = require ('fs');

describe ('sample folder integrity', function(){
  var sampleFolder = path.join(process.cwd(), '/samples');

  describe ('scaffold folder', function(){

    describe ('dashboard file', function(){
      var dashboardFile = path.join(sampleFolder, 'dashboard', 'default.json');
      it('should be valid json', function(done){
        JSON.parse(fs.readFileSync(dashboardFile));
        done();
      });
    });

    describe ('job file', function(){
      var jobFile = path.join(sampleFolder, 'job', 'default.js');
      it('should be valid executable', function(done){
        var job = require(jobFile);
        job({},{}, function(err, data){
          done();
        });
      });
    });
  });

  describe ('project folder', function(){
    var projectFolder = path.join(sampleFolder, 'project');

    describe ('dashboard file', function(){
      var dashboardFile = path.join(projectFolder, 'packages', 'default', 'dashboards', 'myfirst_dashboard.json');
      it('should be valid json', function(done){
        JSON.parse(fs.readFileSync(dashboardFile));
        done();
      });
    });

    describe ('global config file', function(){
      var globalConfigFile = path.join(projectFolder, 'config', 'dashboard_common.json');
      it('should be valid json', function(done){
        JSON.parse(fs.readFileSync(globalConfigFile));
        done();
      });
    });
  });
});